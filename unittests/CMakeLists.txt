if (MSVC)
  add_compile_options(/W4 /WX)
else()
  add_compile_options(-Wall -Wextra -pedantic -Werror)
endif()

add_cxx_compiler_flag(-static)

set(TEST_EXECUTABLE read_data_test tempdir_test utilities_test writer_test )
foreach (test_executable ${TEST_EXECUTABLE})
  ADD_EXECUTABLE(${test_executable} ${test_executable}.cpp)
  TARGET_LINK_LIBRARIES(${test_executable})
  target_code_coverage(${test_executable} AUTO ALL)
  ADD_TEST(${test_executable} ./${test_executable})
endforeach (test_executable)

set(TEST_EXECUTABLE search_test read_stdin_test locate_test)
foreach (test_executable ${TEST_EXECUTABLE})
  ADD_EXECUTABLE(${test_executable} ${test_executable}.cpp)
  TARGET_LINK_LIBRARIES(${test_executable} ${LIB_HS} ${LIB_HS_RUNTIME})
  target_code_coverage(${test_executable} AUTO ALL)
  ADD_TEST(${test_executable} ./${test_executable})
endforeach (test_executable)

ENABLE_TESTING()
